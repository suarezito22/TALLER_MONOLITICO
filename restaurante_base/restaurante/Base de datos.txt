from pathlib import Path

# SQL completo actualizado con validaciones y estructura del sistema
sql_script = """
-- Base de datos: restaurante
CREATE DATABASE IF NOT EXISTS restaurante;
USE restaurante;

-- Tabla: categoria
CREATE TABLE IF NOT EXISTS categoria (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

-- Tabla: mesa
CREATE TABLE IF NOT EXISTS mesa (
    id INT AUTO_INCREMENT PRIMARY KEY,
    nombre VARCHAR(100) NOT NULL
);

-- Tabla: plato
CREATE TABLE IF NOT EXISTS plato (
    id INT AUTO_INCREMENT PRIMARY KEY,
    descripcion VARCHAR(255) NOT NULL,
    id_categoria INT NOT NULL,
    precio_unitario DECIMAL(10,2) NOT NULL,
    cantidad INT NOT NULL,
    FOREIGN KEY (id_categoria) REFERENCES categoria(id)
);

-- Tabla: orden
CREATE TABLE IF NOT EXISTS orden (
    id INT AUTO_INCREMENT PRIMARY KEY,
    fecha DATE NOT NULL,
    id_mesa INT NOT NULL,
    total DECIMAL(10,2) NOT NULL,
    anulada BOOLEAN DEFAULT FALSE,
    FOREIGN KEY (id_mesa) REFERENCES mesa(id)
);

-- Tabla: detalle_orden
CREATE TABLE IF NOT EXISTS detalle_orden (
    id INT AUTO_INCREMENT PRIMARY KEY,
    id_orden INT NOT NULL,
    id_plato INT NOT NULL,
    cantidad INT NOT NULL,
    precio_unitario DECIMAL(10,2) NOT NULL,
    FOREIGN KEY (id_orden) REFERENCES orden(id),
    FOREIGN KEY (id_plato) REFERENCES plato(id)
);
"""

# Guardar como archivo .sql
sql_path = Path("/mnt/data/base_datos_restaurante_actualizada.sql")
sql_path.write_text(sql_script)

sql_path
